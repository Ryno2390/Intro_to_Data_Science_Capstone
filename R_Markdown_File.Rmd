---
title: "R_Markdown_File"
author: "RStudio"
date: "10/9/2018"
output: html_document
URL: https://github.com/Ryno2390/Intro_to_Data_Science_Capstone.git
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Questions to Answer 

### What is the problem you want to solve?

Analyze the voting patterns of the US during the 2016 Presidential election - with a stretch goal of creating a prediction model of who would have won the 2016 Presidential election using FiveThirtyEight's election data. 

### Who is your client and why do they care about this problem? In other words, what will your client DO or DECIDE based on your analysis that they wouldnâ€™t have otherwise?

Generally speakig, lobbyists seek to "back a winning horse" - i.e. they intend to contribute as much money as possible, given their contribution budget constaint, to the winning candidate. Only the winning candidate gains political power, therefore lobbysts do not wish to diluate the power of their contibution budget by donating to multiple candidates in the same race. An accurate prediction model would enable lobbyst clients to make more informed donation decisions. 

### What data are you going to use for this? How will you acquire this data?

I will use FiveThirtyEight.com's data which is readily available through Kaggle (https://www.kaggle.com/fivethirtyeight/2016-election-polls#presidential_polls.csv)

### In brief, outline your approach to solving this problem (knowing that this might change later).

My approach will bet to understand FiveThirtyEight's model and to simplify the model as much as possible to conform with the goals of this course. I will then use the data to analyze regional voting patterns, with a stretch goal of creating a simplified model that can incorporate polling data to update it's prediction of who will win the election.

### What are your deliverables? Typically, this would include code, along with a paper and/or a slide deck.

The deliverables will include:

+ A walkthrough of the model using RMarkdown
+ A detailed summary paper that analyzes regional voting trends as well as a prediction of who would win

# Upload data into RStudio

```{r}
library(readr)

Raw_Data <- read_csv("presidential_polls.csv")

str(Raw_Data)
```

There are many superfluous columns in this data set that are not useful for this project. These include:

+ cycle - all values are the same (i.e. set to "2016")

+ branch - all values are the same (i.e. set to "Presidential")

+ type - this determines which model FiveThirtyEight associates with each poll (i.e. "Now-Cast", "Polls-Only", or "Polls-Plus")

+ matchup - all values are the same (i.e. set to "Clinton vs. Trump vs. Johnson")

+ forecastdate - all values are the same (i.e. set to "11/1/2016")

+ rawpoll_johnson - my model will only compare voting patterns between the final two presidential candidates (i.e. Clinton or Trump) and therefore will exclude data for both Johnson and McMullin

+ rawpoll_mcmullin - my model will only compare voting patterns between the final two presidential candidates (i.e. Clinton or Trump) and therefore will exclude data for both Johnson and McMullin

+ adjpoll_johnson - my model will only compare voting patterns between the final two presidential candidates (i.e. Clinton or Trump) and therefore will exclude data for both Johnson and McMullin

+ adjpoll_mcmullin - my model will only compare voting patterns between the final two presidential candidates (i.e. Clinton or Trump) and therefore will exclude data for both Johnson and McMullin

+ multiversions - this field denotes if there were multiple versions of the same poll. My analysis will not make such a distinction and will simply take each poll at face value.

+ url - links to the original poll data location.

+ poll_id - unique identifier used by FiveThirtyEight cross-over use in other models.

+ question_id - unique identifer to determine the form of the poll question. I do not have access to the reference table for these questions so this will not be included in our data set.

+ createddate - date the data was inputted to the model. Irrelevant for my data set.

+ timestamp - date the model was rerun incorporating all the data up to that point. The model was last updated November 1st, 2018 and is irrelavnt to my data set.

This leaves the following fields in my data set:

+ state - the state from which the poll was taken (the value "U.S." signifies a national poll)

+ startdate - the date for which the poll was begun

+ enddate - the date for which the poll was ended

+ pollster - the organization that conducted the poll

+ grade - the accuraacy rating of the polling organization, as determined by FiveThirtyEight by analyzing past predictions and comparing them to actual results.

+ samplesize - the size of the sample for the poll (i.e. the "n" value)

+ population - ???

+ poll_wt - the weight assigned to each poll predicated on the polling organization's grade

+ rawpoll_clinton - the raw percentage of respondents polled who plan on voting for Hillary Clinton

+ rawpoll_trump - the raw percentage of respondents polled who plan on voting for Donald Trump

+ adjpoll_clinton - the weight adjusted percentage of respondents polled who plan on voting for Hillary Clinton

+ adjpoll_trump - the weight adjusted percentage of respondents polled who plan on voting for Donald Trump

### Remove superfluous columns from the data set to produce a clean data set

```{r}
library(dplyr)

Clean_Data <- Raw_Data %>% select(-c(cycle:forecastdate, rawpoll_johnson, rawpoll_mcmullin, adjpoll_johnson:timestamp))

str(Clean_Data)
```

A quick overview of the "state" column reveals that there are really two different types of polls: purely state polls (which include speocific congressional districts, as well as state-wide polls) and national polls. To get our bearings I will apply some statistics to the purely national polls at first; we will analyze regiaonal variations in polling later.

### Filter the data to include only "U.S." - or national - polls

```{r}
install.packages("lubridate")
library(lubridate)

National_Polls <- Clean_Data %>% 
  select(state, enddate, samplesize, rawpoll_clinton, rawpoll_trump) %>%
  filter(state == "U.S.") %>%
  mutate(enddate = mdy(enddate)) %>%
  arrange(enddate)

str(National_Polls)
```

Now that we have the data we need we can do a simply scatter plot of the the rawpoll_clinton and rawpoll_trump fields over time (i.e. by enddate) to see if there are any patterns. Let's start with Clinton's raw polling data.

### Install ggplot2 and plot the rawpoll_clinton data over time to see if there are any obvious patterns.

```{r}
install.packages("ggplot2")
library("ggplot2")

ggplot(data = National_Polls, aes(x=enddate, y=rawpoll_clinton)) +
  geom_point()
```

Now, let's do the same for Trump's raw polling data.

### Plot the rawpoll_trump data over time to see if there are any obvious patterns.

```{r}
ggplot(data = National_Polls, aes(x=enddate, y=rawpoll_trump)) +
  geom_point()
```

One obvious pattern that stands out is that the number of polls increases over time. This makes sense, since as we get closer to election day, more and more polls are conducted in order to determine who the likely winner will be. Another obvious pattern is that the variation in the polls also increase over time - like a funnel that widens over time. 

Perhaps the most important point to make about the data is that it is quite "noisy" - even temporally close polls can drastically differ in outcome. Smoothing out the data could be helpful in teasing out a meaningful pattern. One potentially useful smoothing technique is a moving average - a rolling average of all polls taken within a certain time frame. A moving average can help us find the "signal" among the "noise".

Let's apply a 100 poll moving average to Clinton's raw polling data and plot it over time. This will provide us with a moving average of the last 100 polls.

```{r}
install.packages("zoo")
library(zoo)

National_Polls <- National_Polls %>%
  mutate(Clinton_MA = rollmean(rawpoll_clinton, 100, na.pad=TRUE, align="right"))

ggplot(data = National_Polls, aes(x=enddate, y=Clinton_MA)) +
  geom_line()
```

Let's now do the same for Trump's raw polling data.

```{r}
National_Polls <- National_Polls %>%
  mutate(Trump_MA = rollmean(rawpoll_trump, 100, na.pad=TRUE, align="right"))

ggplot(data = National_Polls, aes(x=enddate, y=Trump_MA)) +
  geom_line()
```

After smoothing out the data we can see some clear patterns. Early on in the cycle it appears that Clinton had an early and substantial lead in the polls (though this is tempered by the fact that there were fewer polls during this earlier period). However, this early and substantial lead appears to erode over the summer, improving in the fall but never regaining those early leads. In contrast, Trump's polling data improved over time, starting around July, and spiking in the final weeks of the cycle.

Another helpful way of looking at the data is by calculating a margin. So far, the data has been separated into columns for each candidate. Though this is useful, what really matters in elections is which candidate wins a higher percentage of the vote. In other words, what we want to know is the margin between Clinton and Trump.

Since Clinton was favored to win early on, we will subtract Trump's polling figures from Clinton's to arrive at our Margin figure - but we could just as easily done the opposite.

### Calculate the Clinton - Trump margin and plot it over time.

```{r}
National_Polls <- National_Polls %>%
  mutate(Clinton_Margin = Clinton_MA - Trump_MA)

ggplot(National_Polls, aes(x=enddate, y=Clinton_Margin)) +
  geom_line()
```

Using this visualization of margin we can see more clearly the pattern in Clinton's chances of winning the presidency. We see an early rise in her chances as she widened her margin from January through May; however, her chances deteriorated throughout the Summer and Fall - reaching their lowest point in August (where it was actually net negative for the first time), only to regain in mid-September through mid-October period, preciptously falling back down in late October. If this late, falling trend were extended through election day (i.e. November 6th, 2016), it's entirely plausible that Clinton would have had a net negative margin on election day.

# This is NOT a popularity contest

This is all well and interesting but in American presidential elections the president is chosen not through the popular vote but through the Electoral College. If you are interested in learning more about the Electoral College there are great resources online (https://en.wikipedia.org/wiki/United_States_Electoral_College), but at a very basic level, each state recieves a total number of electoral votes equal to its representation in Congress. 

More specifically, each state's total number of electors is equal to the combined total of the state's membership in the Senate and House of Representatives; currently there are 100 senators (2 for each state) and 435 representatives. Additionally, the Twenty-third Amendment of the U.S. Constitution dictates that the District of Columbia (which is NOT a state) is entitled to a number of electors no greater or less than that of the least populous state (i.e. 3 electoral votes), for a total of 538 electoral votes.

Therefore, to win, an American Presidential candidate must win an absolute majority of 270 electoral votes to become president. Therefore, in order to create a model that accurately predicts who will become president, and NOT who will win the most votes, we need to predict the winner in each state, and allocate each state's electoral votes to the predicted winner of each state. The first candidate to 270 wins!

# "Swing" for the Fences!

It would be very useful to categorize each state according to how likely it is that it would vote for Clinton versus how likely it is to vote for Trump, or - even more importantly - if the state is considered a "toss-up". 

On of the most important jobs of a presidential campaign is to determine where to campaign. Every campaign is constrained by its limited resources (volunteers, money, advertisting, ect.), so each campaign must make strategic decisions about which states to campaign in. 

It does not make sense for a campaign to commit resources to a state that is highly unlikely to vote for its candidate, nor does it make sense for a campaign to do the opposite - i.e. to commit resources to a state that is already highly likely to vote for its candidate. Therefore, the optimal use of limited campaign resources is to devote them to "swing" states - i.e. states that could vote for either the campaign's candidate, or their opponent.

Toward this end, a k-means clustering model would help us in determining which states are considered solidly Clinton, which states are solidly Trump, and - most importantly - which states are swing states. By choosing a k = 3, we subdivide the states into Clinton, Trump, and Swing.

```{r}
State_Polls_Swing <- Clean_Data %>%
  select(state, pollster, rawpoll_clinton, rawpoll_trump) %>%
  filter(state != "U.S.") %>%
  filter(state != "Maine CD-1") %>%
  filter(state != "Maine CD-2") %>%
  filter(state != "Nebraska CD-1") %>%
  filter(state != "Nebraska CD-2") %>%
  filter(state != "Nebraska CD-3") %>%
  mutate(Clinton_Margin = rawpoll_clinton - rawpoll_trump)
str(State_Polls_Swing)
```

```{r}
State_Polls_Swing$rawpoll_clinton = NULL
State_Polls_Swing$rawpoll_trump = NULL
State_Polls_Swing <- unique(State_Polls_Swing)

distances_Swing <- dist(State_Polls_Swing, method = "euclidean")
clusterStates_Swing <- hclust(distances_Swing, method = "ward")
plot(clusterStates_Swing)

clusterGroups_Swing <- cutree(clusterStates_Swing, k = 3)
```

```{r}
# Alabama
Alabama_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Alabama"]))
Alabama_Cluster_Swing

# Alaska
Alaska_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Alaska"]))
Alaska_Cluster_Swing

# Arizona
Arizona_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Arizona"]))
Arizona_Cluster_Swing

# Arkansas
Arkansas_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Arkansas"]))
Arkansas_Cluster_Swing

# California
California_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "California"]))
California_Cluster_Swing

# Colorado
Colorado_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Colorado"]))
Colorado_Cluster_Swing

# Connecticut
Connecticut_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Connecticut"]))
Connecticut_Cluster_Swing

# District of Columbia
District_of_Columbia_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "District of Columbia"]))
District_of_Columbia_Cluster_Swing

# Delaware
Delaware_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Delaware"]))
Delaware_Cluster_Swing

# Florida
Florida_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Florida"]))
Florida_Cluster_Swing

# Georgia
Georgia_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Georgia"]))
Georgia_Cluster_Swing

# Hawaii
Hawaii_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Hawaii"]))
Hawaii_Cluster_Swing

# Idaho
Idaho_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Idaho"]))
Idaho_Cluster_Swing

# Illinois
Illinois_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Illinois"]))
Illinois_Cluster_Swing

# Indiana
Indiana_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Indiana"]))
Indiana_Cluster_Swing

# Iowa
Iowa_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Iowa"]))
Iowa_Cluster_Swing

# Kansas
Kansas_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Kansas"]))
Kansas_Cluster_Swing

# Kentucky
Kentucky_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Kentucky"]))
Kentucky_Cluster_Swing

# Louisiana
Louisiana_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Louisiana"]))
Louisiana_Cluster_Swing

# Maine
Maine_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Maine"]))
Maine_Cluster_Swing

# Maryland
Maryland_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Maryland"]))
Maryland_Cluster_Swing

# Massachusetts
Massachusetts_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Massachusetts"]))
Massachusetts_Cluster_Swing

# Michigan
Michigan_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Michigan"]))
Michigan_Cluster_Swing

# Minnesota
Minnesota_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Minnesota"]))
Minnesota_Cluster_Swing

# Mississippi
Mississippi_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Mississippi"]))
Mississippi_Cluster_Swing

# Missouri
Missouri_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Missouri"]))
Missouri_Cluster_Swing

# Montana
Montana_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Montana"]))
Montana_Cluster_Swing

# Nebraska
Nebraska_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Nebraska"]))
Nebraska_Cluster_Swing

# Nevada
Nevada_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Nevada"]))
Nevada_Cluster_Swing

# New Hampshire
New_Hampshire_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "New Hampshire"]))
New_Hampshire_Cluster_Swing

# New Jersey
New_Jersey_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "New Jersey"]))
New_Jersey_Cluster_Swing

# New Mexico
New_Mexico_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "New Mexico"]))
New_Mexico_Cluster_Swing

# New York
New_York_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "New York"]))
New_York_Cluster_Swing

# North Carolina
North_Carolina_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "North Carolina"]))
North_Carolina_Cluster_Swing

# North Dakota
North_Dakota_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "North Dakota"]))
North_Dakota_Cluster_Swing

# Ohio
Ohio_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Ohio"]))
Ohio_Cluster_Swing

# Oklahoma
Oklahoma_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Oklahoma"]))
Oklahoma_Cluster_Swing

# Oregon
Oregon_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Oregon"]))
Oregon_Cluster_Swing

# Pennsylvania
Pennsylvania_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Pennsylvania"]))
Pennsylvania_Cluster_Swing

# Rhode Island
Rhode_Island_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Rhode Island"]))
Rhode_Island_Cluster_Swing

# South Carolina
South_Carolina_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "South Carolina"]))
South_Carolina_Cluster_Swing

# South Dakota
South_Dakota_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "South Dakota"]))
South_Dakota_Cluster_Swing

# Tennessee
Tennessee_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Tennessee"]))
Tennessee_Cluster_Swing

# Texas
Texas_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Texas"]))
Texas_Cluster_Swing

# Utah
Utah_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Utah"]))
Utah_Cluster_Swing

# Vermont
Vermont_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Vermont"]))
Vermont_Cluster_Swing

# Virginia
Virginia_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Virginia"]))
Virginia_Cluster_Swing

# Washington
Washington_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Washington"]))
Washington_Cluster_Swing

# West Virginia
West_Virginia_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "West Virginia"]))
West_Virginia_Cluster_Swing

# Wisconsin
Wisconsin_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Wisconsin"]))
Wisconsin_Cluster_Swing

# Wyoming
Wyoming_Cluster_Swing <- round(mean(clusterGroups_Swing[State_Polls_Swing$state == "Wyoming"]))
Wyoming_Cluster_Swing
```

```{r}
# Alaska
mean(clusterGroups_Swing[State_Polls_Swing$state == "Alaska"])
Alaska_Data <- Clean_Data %>%
  filter(state == "Alaska")

# Arizona
mean(clusterGroups_Swing[State_Polls_Swing$state == "Arizona"])
Arizona_Data <- Clean_Data %>%
  filter(state == "Arizona")

# Florida
mean(clusterGroups_Swing[State_Polls_Swing$state == "Florida"])
Florida_Data <- Clean_Data %>%
  filter(state == "Florida")

# Georgia
mean(clusterGroups_Swing[State_Polls_Swing$state == "Georgia"])
Georgia_Data <- Clean_Data %>%
  filter(state == "Georgia")

# Indiana
mean(clusterGroups_Swing[State_Polls_Swing$state == "Indiana"])
Indiana_Data <- Clean_Data %>%
  filter(state == "Indiana")

# Iowa
mean(clusterGroups_Swing[State_Polls_Swing$state == "Iowa"])
Iowa_Data <- Clean_Data %>%
  filter(state == "Iowa")

# Kansas
mean(clusterGroups_Swing[State_Polls_Swing$state == "Kansas"])
Kansas_Data <- Clean_Data %>%
  filter(state == "Kansas")

# Missouri
mean(clusterGroups_Swing[State_Polls_Swing$state == "Missouri"])
Missouri_Data <- Clean_Data %>%
  filter(state == "Missouri")

# Nevada
mean(clusterGroups_Swing[State_Polls_Swing$state == "Nevada"])
Nevada_Data <- Clean_Data %>%
  filter(state == "Nevada")

# North Carolina
mean(clusterGroups_Swing[State_Polls_Swing$state == "North Carolina"])
North_Carolina_Data <- Clean_Data %>%
  filter(state == "North Carolina")

# Ohio
mean(clusterGroups_Swing[State_Polls_Swing$state == "Ohio"])
Ohio_Data <- Clean_Data %>%
  filter(state == "Ohio")

# South Carolina
mean(clusterGroups_Swing[State_Polls_Swing$state == "South Carolina"])
South_Carolina_Data <- Clean_Data %>%
  filter(state == "South Carolina")

# Texas
mean(clusterGroups_Swing[State_Polls_Swing$state == "Texas"])
Texas_Data <- Clean_Data %>%
  filter(state == "Texas")

# Utah
mean(clusterGroups_Swing[State_Polls_Swing$state == "Utah"])
Utah_Data <- Clean_Data %>%
  filter(state == "Utah")
```

Let's look at these swing states in order of most Democratic leaning to least Democratic leaning (along with each state's electoral votes):

1. Florida (29)
2. Iowa (6)
3. Arizona (11)
4. Ohio (18)
5. North Carolina (15)
6. Nevada (6)
7. Georgia (16)*
8. Kansas (6)*
9. Alaska (3)*
10. Missouri (10)*
11. Utah (6)*
12. South Carolina (9)*
13. Indiana (11)*
14. Texas (38)*

*Indicates that this state leans Republican (i.e. has a mean cluster values greater than 2)

If we eliminate the Republican leaning states we are left with the following list of Democratic leaning swing states:

1. Florida (29)
2. Iowa (6)
3. Arizona (11)
4. Ohio (18)
5. North Carolina (15)
6. Nevada (6)

If we then order this list in descending order of electoral votes, we get the following "hit list" of swing states:

1. Florida (29)
2. Ohio (18)
3. North Carolina (15)
4. Arizona (11)
5. Iowa (6)
6. Nevada (6)

This "hit list", represents the states that, according to the model, Clinton should focus on in order to improve her chances of reaching 270 electoral votes.

```{r}
State_Polls_Final <- State_Polls_Swing

distances_Final <- dist(State_Polls_Final, method = "euclidean")
clusterStates_Final <- hclust(distances_Final, method = "ward")

clusterGroups_Final <- cutree(clusterStates_Final, k = 2)
```

```{r}
# Alabama
Alabama_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Alabama"]))
Alabama_Cluster_Final

# Alaska
Alaska_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Alaska"]))
Alaska_Cluster_Final

# Arizona
Arizona_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Arizona"]))
Arizona_Cluster_Final

# Arkansas
Arkansas_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Arkansas"]))
Arkansas_Cluster_Final

# California
California_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "California"]))
California_Cluster_Final

# Colorado
Colorado_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Colorado"]))
Colorado_Cluster_Final

# Connecticut
Connecticut_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Connecticut"]))
Connecticut_Cluster_Final

# District of Columbia
District_of_Columbia_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "District of Columbia"]))
District_of_Columbia_Cluster_Final

# Delaware
Delaware_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Delaware"]))
Delaware_Cluster_Final

# Florida
Florida_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Florida"]))
Florida_Cluster_Final

# Georgia
Georgia_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Georgia"]))
Georgia_Cluster_Final

# Hawaii
Hawaii_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Hawaii"]))
Hawaii_Cluster_Final

# Idaho
Idaho_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Idaho"]))
Idaho_Cluster_Final

# Illinois
Illinois_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Illinois"]))
Illinois_Cluster_Final

# Indiana
Indiana_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Indiana"]))
Indiana_Cluster_Final

# Iowa
Iowa_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Iowa"]))
Iowa_Cluster_Final

# Kansas
Kansas_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Kansas"]))
Kansas_Cluster_Final

# Kentucky
Kentucky_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Kentucky"]))
Kentucky_Cluster_Final

# Louisiana
Louisiana_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Louisiana"]))
Louisiana_Cluster_Final

# Maine
Maine_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Maine"]))
Maine_Cluster_Final

# Maryland
Maryland_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Maryland"]))
Maryland_Cluster_Final

# Massachusetts
Massachusetts_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Massachusetts"]))
Massachusetts_Cluster_Final

# Michigan
Michigan_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Michigan"]))
Michigan_Cluster_Final

# Minnesota
Minnesota_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Minnesota"]))
Minnesota_Cluster_Final

# Mississippi
Mississippi_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Mississippi"]))
Mississippi_Cluster_Final

# Missouri
Missouri_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Missouri"]))
Missouri_Cluster_Final

# Montana
Montana_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Montana"]))
Montana_Cluster_Final

# Nebraska
Nebraska_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Nebraska"]))
Nebraska_Cluster_Final

# Nevada
Nevada_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Nevada"]))
Nevada_Cluster_Final

# New Hampshire
New_Hampshire_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "New Hampshire"]))
New_Hampshire_Cluster_Final

# New Jersey
New_Jersey_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "New Jersey"]))
New_Jersey_Cluster_Final

# New Mexico
New_Mexico_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "New Mexico"]))
New_Mexico_Cluster_Final

# New York
New_York_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "New York"]))
New_York_Cluster_Final

# North Carolina
North_Carolina_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "North Carolina"]))
North_Carolina_Cluster_Final

# North Dakota
North_Dakota_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "North Dakota"]))
North_Dakota_Cluster_Final

# Ohio
Ohio_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Ohio"]))
Ohio_Cluster_Final

# Oklahoma
Oklahoma_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Oklahoma"]))
Oklahoma_Cluster_Final

# Oregon
Oregon_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Oregon"]))
Oregon_Cluster_Final

# Pennsylvania
Pennsylvania_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Pennsylvania"]))
Pennsylvania_Cluster_Final

# Rhode Island
Rhode_Island_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Rhode Island"]))
Rhode_Island_Cluster_Final

# South Carolina
South_Carolina_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "South Carolina"]))
South_Carolina_Cluster_Final

# South Dakota
South_Dakota_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "South Dakota"]))
South_Dakota_Cluster_Final

# Tennessee
Tennessee_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Tennessee"]))
Tennessee_Cluster_Final

# Texas
Texas_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Texas"]))
Texas_Cluster_Final

# Utah
Utah_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Utah"]))
Utah_Cluster_Final

# Vermont
Vermont_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Vermont"]))
Vermont_Cluster_Final

# Virginia
Virginia_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Virginia"]))
Virginia_Cluster_Final

# Washington
Washington_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Washington"]))
Washington_Cluster_Final

# West Virginia
West_Virginia_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "West Virginia"]))
West_Virginia_Cluster_Final

# Wisconsin
Wisconsin_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Wisconsin"]))
Wisconsin_Cluster_Final

# Wyoming
Wyoming_Cluster_Final <- round(mean(clusterGroups_Final[State_Polls_Final$state == "Wyoming"]))
Wyoming_Cluster_Final
```

